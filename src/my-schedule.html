<html><head><meta charset="UTF-8"><link rel="import" href="transit-app.html"></head><body><dom-module id="my-schedule">

  <template>
    <style is="schedule-style" include="iron-flex iron-flex-alignment">:host{display:block;padding:10px;--paper-tab-content:{background-color:cadetblue;};--paper-tabs-selection-bar-color:white;--paper-tabs:{border-radius:5%;};}.flex{-webkit-flex-basis:auto !important;flex-basis:auto !important;}.card{box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);padding:16px;margin:24px;border-radius:5px;background-color:#fff;color:#757575;}h1{font-size:22px;margin:16px 0;color:#212121;}*[hidden]{display:none !important;}.flex > *{margin-bottom:20px;}paper-tab{width:100px;color:black;}table{border-collapse:collapse;border-spacing:0;background-color:white;line-height:1em;font-size:8pt;color:black;}td{border:1px solid lightgrey;text-align:center;font-size:6pt;padding:3px;}tbody tr td:nth-child(odd){background-color:#ccc;}th.rotate{height:140px;white-space:nowrap;}th.rotate > div{transform:translate(25px, 51px)
         rotate(315deg);width:30px;}th.rotate > div > span{border-top:1px solid #ccc;border-bottom:1px solid #ccc;padding:5px 10px;}.scrollableTable{height:300px;overflow:auto;}@media screen and (max-width: 767px){.scrollableTable{width:80vw;}}</style>

    <div class="card flex layout wrap vertical center center-justified wrap">
      <h1>Train Schedules</h1>
      <br>
      <paper-dropdown-menu label="Route">
        <paper-listbox class="dropdown-content" selected="{{route}}" attr-for-selected="name" aria-label="Route Selector">
          <paper-item name="blue">Blue Line</paper-item>
          <paper-item name="green">Green Line</paper-item>
          <paper-item name="northstar">Northstar</paper-item>
        </paper-listbox>
      </paper-dropdown-menu>

      <div class="flex layout center horizontal around-justified wrap self-stretch" hidden$="[[!_routePicked]]">
        <paper-tabs label="Direction" selected="{{direction}}" attr-for-selected="name">
          <paper-tab hidden$="[[!_showNS]]" name="N">North</paper-tab>
          <paper-tab hidden$="[[!_showNS]]" name="S">South</paper-tab>
          <paper-tab hidden$="[[_showNS]]" name="E">East</paper-tab>
          <paper-tab hidden$="[[_showNS]]" name="W">West</paper-tab>
        </paper-tabs>

        <paper-tabs label="Day" selected="{{day}}" attr-for-selected="name">
          <paper-tab name="Weekday">Weekday</paper-tab>
          <paper-tab name="Saturday">Saturday</paper-tab>
          <paper-tab name="Sunday">Sunday</paper-tab>
        </paper-tabs>
      </div>

      <section hidden$="[[!scheduleLoaded]]">
        <div class="scrollableTable">
          <table border="0" cell-padding="0" cell-spacing="0">
            <thead>
              <tr>
                <template is="dom-repeat" items="[[titles]]" as="title">
                  <th class="rotate"><div><span>[[title]]</span></div></th>
                </template>
              </tr>
            </thead>
            <tbody>
              <template is="dom-repeat" items="[[schedules]]" as="schedule">
                <tr>
                  <template is="dom-repeat" items="[[schedule]]" as="time">
                    <td>[[time]]</td>
                  </template>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </section>
    </div>

  </template>

  <script>Polymer({is:"my-schedule",properties:{route:{type:String,notify:!0},_routePicked:{type:Boolean,value:!1},_showNS:{type:Boolean},direction:{type:String,notify:!0},_directionPicked:{type:Boolean},day:{type:String,notify:!0,value:function(){return"Weekday"}},filteredStations:{type:Array,notify:!0},titles:{type:Array,notify:!0},schedules:{type:Array,notify:!0},scheduleLoaded:{type:Boolean,value:!1}},observers:["displayDirection(route)","filterStations(route, direction)","fetchSchedule(route, direction, day)"],displayDirection:function(t){"green"==t?(this.direction="E",this._showNS=!1):(this.direction="N",this._showNS=!0),this._routePicked=!0},filterStations:function(t,e){var i=app.stations.filter(function(i){return i.route==t&&i.direction==e});this.filteredStations=app.listStations(i),this._directionPicked=!0},largestSubVec:function(t){return t.reduce(function(t,e){var i=e.length;return t>i?t:i})},flip2dArray:function(t){var e,i,r=[],n=[],o=this.largestSubVec(t);for(e=0;o>e;e++){for(i=0;i<t.length;i++){var s=t[i][e]||"-";n.push(s)}r.push(n),n=[]}return r},fetchSchedule:function(t,e,i){var r=this.scheduleData,n=app.stations.filter(function(i){return i.direction==e&&i.route==t});n.sort(function(t,e){var i=t.position,r=e.position;return r>i?-1:i>r?1:0}),this.titles=n.map(function(t){return t.title});var o=n.map(function(t){var e=t.id;return r[e][i]});this.schedules=this.flip2dArray(o),this.scheduleLoaded=!0}});</script>

</dom-module>
</body></html>